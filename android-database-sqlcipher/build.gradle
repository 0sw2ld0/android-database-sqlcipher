apply plugin: "com.android.library"
apply from: "native.gradle"

android {

  compileSdkVersion 26
  buildToolsVersion "26.0.1"

  defaultConfig {
    minSdkVersion 14
    targetSdkVersion 26
    versionCode 1
    versionName "${rootProject.ext.clientVersionNumber}"
  }

  buildTypes {
    release {
      minifyEnabled false
    }
  }

  sourceSets {
    main {
      jniLibs.srcDirs "${rootProject.ext.nativeRootOutputDir}/libs32/",
      "${rootProject.ext.nativeRootOutputDir}/libs64/"
    }
  }

  task distclean(dependsOn: [clean, cleanSQLCipher, cleanOpenSSL]) {
    description "Clean up build, SQLCipher, and OpenSSL artifacts"
  }

  clean.dependsOn cleanNative

  preBuild.dependsOn buildAmalgamation

  afterEvaluate {
    android.libraryVariants.all { variant ->
      variant.javaCompile.dependsOn([buildNative32, buildNative64])
    }
  }

}
